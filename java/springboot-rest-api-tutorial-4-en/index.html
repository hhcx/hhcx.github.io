<!DOCTYPE html><html class="theme-next gemini use-motion" lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|PingFang SC:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"><link rel="stylesheet" href="/css/main.css?v=7.1.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.1"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.1"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.1"><link rel="mask-icon" href="/images/logo.svg?v=7.1.1" color="#222"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"7.1.1",sidebar:{position:"left",display:"post",offset:12,onmobile:!0,dimmer:!1},back2top:!0,back2top_sidebar:!0,fancybox:!1,fastclick:!1,lazyload:!1,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="amphtml" href="./amp/index.html"><meta name="description" content="In the previous article of the series, I will show you how to format the data returned by the Restful service interface in Spring Boot. This article will continue in depth and demonstrate how to verif"><meta name="keywords" content="REST Service, Spring Boot, Java"><meta property="og:type" content="article"><meta property="og:title" content="How to build Rest Service with Spring Boot - A Step by Step Tutorial for Beginner - 4"><meta property="og:url" content="https://www.mls-tech.info/java/springboot-rest-api-tutorial-4-en/index.html"><meta property="og:site_name" content="Morning Star&#39;s blog"><meta property="og:description" content="In the previous article of the series, I will show you how to format the data returned by the Restful service interface in Spring Boot. This article will continue in depth and demonstrate how to verif"><meta property="og:locale" content="en"><meta property="og:updated_time" content="2022-01-21T01:17:02.240Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="How to build Rest Service with Spring Boot - A Step by Step Tutorial for Beginner - 4"><meta name="twitter:description" content="In the previous article of the series, I will show you how to format the data returned by the Restful service interface in Spring Boot. This article will continue in depth and demonstrate how to verif"><link rel="alternate" href="/atom.xml" title="Morning Star's blog" type="application/atom+xml"><link rel="canonical" href="https://www.mls-tech.info/java/springboot-rest-api-tutorial-4-en/"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>How to build Rest Service with Spring Boot - A Step by Step Tutorial for Beginner - 4 | Morning Star's blog</title><script async src="//www.googletagmanager.com/gtag/js?id=UA-141018422-1"></script><script>var host=window.location.hostname;function gtag(){dataLayer.push(arguments)}"localhost"!==host&&(window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-141018422-1"))</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-0765167544575057",enable_page_level_ads:!0})</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="en"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Morning Star's blog</span> <span class="logo-line-after"><i></i></span></a></div></div><div class="site-nav-toggle"><button aria-label="Toggle navigation bar"><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>Categories</a></li><li class="menu-item menu-item-search"><a href="/search/" rel="section"><i class="menu-item-icon fa fa-fw fa-search"></i><br>Search</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>Archives</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>About</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.mls-tech.info/java/springboot-rest-api-tutorial-4-en/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Morning Star"><meta itemprop="description" content><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Morning Star's blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">How to build Rest Service with Spring Boot - A Step by Step Tutorial for Beginner - 4</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2022-01-19 12:24:19" itemprop="dateCreated datePublished" datetime="2022-01-19T12:24:19+08:00">2022-01-19</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">Edited on</span> <time title="Modified: 2022-01-21 09:17:02" itemprop="dateModified" datetime="2022-01-21T09:17:02+08:00">2022-01-21</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a></span> , <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/java/springboot/" itemprop="url" rel="index"><span itemprop="name">SpringBoot</span></a></span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> Views: <span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span title="Symbols count in article">7.5k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span title="Reading time">12 mins.</span></div></div></header><div class="post-body" itemprop="articleBody"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block;text-align:center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-0765167544575057" data-ad-slot="7762662182"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><p>In <a href="/java/springboot-rest-api-tutorial-3-en/" title="the previous article">the previous article</a> of the series, I will show you how to format the data returned by the Restful service interface in Spring Boot. This article will continue in depth and demonstrate how to verify the validity of the entered data.</p><a id="more"></a><p>User input data validation is a task that must be completed by the server-side system, and Spring Boot has built-in support for [JSR 303 Bean Validation] (<a href="https://beanvalidation.org/1.0/spec/)" rel="external nofollow noopener noreferrer" target="_blank">https://beanvalidation.org/1.0/spec/)</a>, which together with minimal programming (AOP) makes the task of data validation very simple.</p><h2 id="Add-validation-logic"><a href="#Add-validation-logic" class="headerlink" title="Add validation logic"></a>Add validation logic</h2><p>First, we implement a simple validation rule with validation annotations supported by JSR 303: title cannot be empty.</p><p>To implement this rule, you only need to add annotations to the corresponding properties of the entity class, as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Todo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy=GenerationType.AUTO)</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>As you can see, we’ve annotated @NotNull on the title property of the Todo class to limit that property from being null. <strong>Note that here the empty and empty strings are two different annotations</strong></p><p>After you have changed it, run the program, access this API in Postman, and enter the following parameters in the body:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"desc"</span>:<span class="string">"desc of task 1"</span>&#125;</span><br></pre></td></tr></table></figure><p>Get the following return:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"timestamp"</span>: <span class="string">"2019-07-16T01:27:17.388+0000"</span>,</span><br><span class="line">    <span class="attr">"status"</span>: <span class="number">400</span>,</span><br><span class="line">    <span class="attr">"error"</span>: <span class="string">"Bad Request"</span>,</span><br><span class="line">    <span class="attr">"errors"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"codes"</span>: [</span><br><span class="line">                <span class="string">"NotNull.todo.title"</span>,</span><br><span class="line">                <span class="string">"NotNull.title"</span>,</span><br><span class="line">                <span class="string">"NotNull.java.lang.String"</span>,</span><br><span class="line">                <span class="string">"NotNull"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"arguments"</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">"codes"</span>: [</span><br><span class="line">                        <span class="string">"todo.title"</span>,</span><br><span class="line">                        <span class="string">"title"</span></span><br><span class="line">                    ],</span><br><span class="line">                    <span class="attr">"arguments"</span>: <span class="literal">null</span>,</span><br><span class="line">                    <span class="attr">"defaultMessage"</span>: <span class="string">"title"</span>,</span><br><span class="line">                    <span class="attr">"code"</span>: <span class="string">"title"</span></span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"defaultMessage"</span>: <span class="string">"不能为null"</span>,</span><br><span class="line">            <span class="attr">"objectName"</span>: <span class="string">"todo"</span>,</span><br><span class="line">            <span class="attr">"field"</span>: <span class="string">"title"</span>,</span><br><span class="line">            <span class="attr">"rejectedValue"</span>: <span class="literal">null</span>,</span><br><span class="line">            <span class="attr">"bindingFailure"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">"code"</span>: <span class="string">"NotNull"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"message"</span>: <span class="string">"Validation failed for object='todo'. Error count: 1"</span>,</span><br><span class="line">    <span class="attr">"path"</span>: <span class="string">"/todo"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>As you can see, @NotNull is already working. The data was not inserted into the database and an error message was returned - defaultMessage</p><p>[JSR 303 Bean Validation] (<a href="https://beanvalidation.org/1.0/spec/" rel="external nofollow noopener noreferrer" target="_blank">https://beanvalidation.org/1.0/spec/</a>) provides a number of ready-made verification rules, you can refer to its official documentation.</p><h2 id="Uniform-return-format-for-error"><a href="#Uniform-return-format-for-error" class="headerlink" title="Uniform return format for error"></a>Uniform return format for error</h2><p>Now we can easily use validation rules to verify the data, but the returned error format is the standard format in Spring Boot, and the return format we defined in <a href="/java/springboot-rest-api-tutorial-3-en/" title="previous article">previous article</a>, which will lead to client development needs to use different code for different situations to deal with, which is not conducive to system maintenance. Therefore, we need to convert the format of the returned data.</p><p>Converting error handling in Spring Boot is as simple as adding a handling method to the RestController class, specifically adding a handleException method to The TodoApi and then decorating the method with a @ExceptionHandler annotation indicating that it is used to handle exceptions. The code is as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ExceptionHandler</span></span><br><span class="line"><span class="meta">@ResponseStatus</span>(HttpStatus.BAD_REQUEST)</span><br><span class="line"><span class="function"><span class="keyword">public</span> ApiResult <span class="title">handleException</span><span class="params">(MethodArgumentNotValidException exception)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ApiResult.ApiResultBuilder builder = ApiResult.builder().succ(<span class="keyword">false</span>).build().toBuilder();</span><br><span class="line"></span><br><span class="line">    String errorMsg = exception.getBindingResult().getFieldErrors().stream()</span><br><span class="line">            .map(DefaultMessageSourceResolvable::getDefaultMessage)</span><br><span class="line">            .findFirst()</span><br><span class="line">            .orElse(exception.getMessage());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> builder.msg(errorMsg).build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>After running the program after modification and accessing it with Postman, you can find that the information has become our unified format. The client only needs to judge succ to know whether the call was successful, and if not, it takes the information of the msg.</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"succ"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"code"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"msg"</span>: <span class="string">"Can not null"</span>,</span><br><span class="line">    <span class="attr">"data"</span>: <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Use-global-error-handling"><a href="#Use-global-error-handling" class="headerlink" title="Use global error handling"></a>Use global error handling</h2><p>In the above method, we standardize the error handling information by adding methods to the RestController, considering that if there are many RestControllers in the system, it is too cumbersome and not conducive to maintenance, then there is no global<br>What about the unified approach?</p><p>Of course, with Spring’s AOP - Facet Programming feature, it is easy to implement and look directly at the code:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Order</span>(Ordered.HIGHEST_PRECEDENCE)</span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RestExceptionHandler</span> <span class="keyword">extends</span> <span class="title">ResponseEntityExceptionHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> ResponseEntity&lt;Object&gt; <span class="title">handleMethodArgumentNotValid</span><span class="params">(MethodArgumentNotValidException exception, HttpHeaders headers, HttpStatus status, WebRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        ApiResult.ApiResultBuilder builder = ApiResult.builder().succ(<span class="keyword">false</span>).build().toBuilder();</span><br><span class="line"></span><br><span class="line">        String errorMsg = exception.getBindingResult().getFieldErrors().stream()</span><br><span class="line">                .map(DefaultMessageSourceResolvable::getDefaultMessage)</span><br><span class="line">                .findFirst()</span><br><span class="line">                .orElse(exception.getMessage());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> handleExceptionInternal(exception, builder.msg(errorMsg).build(), headers, HttpStatus.BAD_REQUEST, request);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>In the code, we define a RestExceptionHandler class, which inherits from the ResponseEntityExceptionHandler. ResponseEntityExceptionHandler is a class built into Spring Boot, providing basic methods and mechanisms for handling errors and exceptions, we can override its methods to obtain exception handling capabilities for specific processing procedures, and then insert classes into the rest request process through @ControllerAdvice this AOP annotation.</p><p>With this class, we can delete the handleException that we just added to RestController.</p><p>After modifying it, run the program, access it with Postman, and you can see the same result as the previous section.</p><h2 id="Handle-business-logic-errors"><a href="#Handle-business-logic-errors" class="headerlink" title="Handle business logic errors"></a>Handle business logic errors</h2><p>The above we are through the JSR 303 annotation of the data verification, which is feasible for some relatively simple data verification, but for more complex verification scenarios (such as the need to check the database, according to the query results to determine whether it is correct), JSR303 is a bit inadequate, then it needs to be verified in the business object. In our case, data validation should be done in the TodoBiz class under the biz package. As an example, suppose the title attribute has a restriction that can only be “tom”. Then we add validation to TodoBiz’s business method addTodo as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addTodo</span><span class="params">(Todo todo)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="string">"tom"</span>.equals(todo.getTitle())) &#123;</span><br><span class="line">        todoRepository.save(todo);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> BizException(<span class="string">"Title can not be tom"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Here, our custom exception class BizException is used to throw exceptions to the presentation layer - RestController. BizException is defined as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BizException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BizException</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(msg, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Note that we inherit runtimeException, which has two benefits:</strong></p><ol><li>There is no need to force the use of try … in code that uses business classes (in this case, API classes) Catch structure to simplify the code.</li><li>You can trigger Spring Boot’s transaction management mechanism to roll back transactions.</li></ol><p>Then we add method classes to RestExceptionHandler to handle BizException uniformly.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ExceptionHandler</span>(&#123;BizException<span class="class">.<span class="keyword">class</span>&#125;)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">ResponseEntity</span>&lt;<span class="title">Object</span>&gt; <span class="title">handleBizException</span>(<span class="title">BizException</span> <span class="title">e</span>, <span class="title">WebRequest</span> <span class="title">request</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    ApiResult.ApiResultBuilder builder = ApiResult.builder().succ(<span class="keyword">false</span>).build().toBuilder();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;Object&gt;(builder.msg(e.getMessage()).build(), <span class="keyword">new</span> HttpHeaders(), HttpStatus.OK);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>With this modification, we can further simplify the code for apIs and remove try… Catch structure. The new code is as follows:</p><p>TodoApi.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/todo"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ApiResult <span class="title">addTodo</span><span class="params">(@Valid @RequestBody Todo todo)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        ApiResult.ApiResultBuilder builder = ApiResult.builder().succ(<span class="keyword">false</span>).build().toBuilder();</span><br><span class="line"></span><br><span class="line"><span class="comment">//        try &#123;</span></span><br><span class="line">            todoBiz.addTodo(todo);</span><br><span class="line"></span><br><span class="line">            builder.succ(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//        &#125; catch(BizException e) &#123;</span></span><br><span class="line"><span class="comment">//            builder.msg(e.getMessage());</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> builder.build();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>When you have finished changing the code, run the program, access it with Postman, using the following parameters:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"title"</span>:<span class="string">"tom"</span>, <span class="attr">"desc"</span>:<span class="string">"desc of task 1"</span>&#125;</span><br></pre></td></tr></table></figure><p>You can get the following results:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"succ"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"code"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"msg"</span>: <span class="string">"Title can not be tom"</span>,</span><br><span class="line">    <span class="attr">"data"</span>: <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Next"><a href="#Next" class="headerlink" title="Next"></a>Next</h2><p>In <a href="/java/springboot-rest-api-tutorial-5-en/" title="next article">next article</a>, you’ll learn how to use Swagger to automatically generate documentation and test pages for your API.</p></div><div class="popular-posts-header">Related Articles</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/test/test-jmeter-rest-api-01/" rel="bookmark">使用JMeter测试Rest API(一)</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/java/compile-openjdk8-in-ubuntu/" rel="bookmark">在 Ubuntu 环境中编译 OpenJDK 8</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/java/eclipse-favorites-config-plugins/" rel="bookmark">常用的Eclipse配置项和插件</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/java/eclipse-maven-dependency-jdk-tools-jar-error/" rel="bookmark">解决Maven项目中找不到jdk自带的tools.jar的错误</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/java/eclipse-setup-workspace/" rel="bookmark">为Eclipse指定workspace的方法</a></div></li></ul><div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-0765167544575057" data-ad-slot="9592363579" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><div class="my_post_copyright"><script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script><script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script><script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script><p><span>本文标题:</span><a href="/java/springboot-rest-api-tutorial-4-en/">How to build Rest Service with Spring Boot - A Step by Step Tutorial for Beginner - 4</a></p><p><span>文章作者:</span><a href="/" title="访问 Morning Star 的个人博客">Morning Star</a></p><p><span>发布时间:</span>2022年01月19日 - 12:01</p><p><span>最后更新:</span>2022年01月21日 - 09:01</p><p><span>原始链接:</span><a href="/java/springboot-rest-api-tutorial-4-en/" title="How to build Rest Service with Spring Boot - A Step by Step Tutorial for Beginner - 4">https://www.mls-tech.info/java/springboot-rest-api-tutorial-4-en/</a> <span class="copy-path" title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="https://www.mls-tech.info/java/springboot-rest-api-tutorial-4-en/" aria-label="复制成功！"></i></span></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p></div><script>var clipboard=new Clipboard(".fa-clipboard");$(".fa-clipboard").click(function(){clipboard.on("success",function(){swal({title:"",text:"复制成功",icon:"success",showConfirmButton:!0})})})</script></div><footer class="post-footer"><div class="post-tags"><a href="/tags/java/" rel="tag"># java</a></div><div class="post-widgets"><div class="social_share"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/java/java-public-key-retrieval-not-allowed-en/" rel="next" title="Connection MySQL Error - Public Key Retrieval is not allowed"><i class="fa fa-chevron-left"></i> Connection MySQL Error - Public Key Retrieval is not allowed</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/java/spring-boot-web-application-with-jsp/" rel="prev" title="Spring Boot Web Application Example with JSP(Update to Spring Boot 2.6 and Java 17)">Spring Boot Web Application Example with JSP(Update to Spring Boot 2.6 and Java 17) <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">Table of Contents</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">Overview</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Morning Star"><p class="site-author-name" itemprop="name">Morning Star</p><div class="site-description motion-element" itemprop="description"></div></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">579</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">42</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">43</span> <span class="site-state-item-name">tags</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/MaxM2013" title="GitHub &rarr; https://github.com/MaxM2013" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-fw fa-fab fa-github"></i></a> </span><span class="links-of-author-item"><a href="mailto:mls-tech@outlook.com" title="E-Mail &rarr; mailto:mls-tech@outlook.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-fw fa-fa fa-envelope"></i></a> </span><span class="links-of-author-item"><a href="https://www.facebook.com/Mlstech2013" title="FB Page &rarr; https://www.facebook.com/Mlstech2013" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-fw fa-facebook"></i></a> </span><span class="links-of-author-item"><a href="https://www.youtube.com/channel/UC2PKa97_c2YaDEYsaXN8KNQ" title="YouTube &rarr; https://www.youtube.com/channel/UC2PKa97_c2YaDEYsaXN8KNQ" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-fw fa-youtube"></i></a></span></div><div class="wechat_channel"><br><img src="/images/wechat_channel.png"></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-0765167544575057" data-ad-slot="6828020316" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Add-validation-logic"><span class="nav-number">1.</span> <span class="nav-text">Add validation logic</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Uniform-return-format-for-error"><span class="nav-number">2.</span> <span class="nav-text">Uniform return format for error</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Use-global-error-handling"><span class="nav-number">3.</span> <span class="nav-text">Use global error handling</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Handle-business-logic-errors"><span class="nav-number">4.</span> <span class="nav-text">Handle business logic errors</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Next"><span class="nav-number">5.</span> <span class="nav-text">Next</span></a></li></ol></div></div></div><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2022</span> <span class="with-love" id="animate"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Morning Star</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span title="Symbols count total">1.1m</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="Reading time total">31:10</span></div><div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> v3.9.0</div><span class="post-meta-divider">|</span><div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="external nofollow noopener noreferrer" target="_blank">NexT.Gemini</a> v7.1.1</div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="Total Visitors"><span class="busuanzi-value" id="busuanzi_value_site_uv"></span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="Total Views"><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/lib/three/three.min.js"></script><script src="/lib/three/three-waves.min.js"></script><script src="/js/utils.js?v=7.1.1"></script><script src="/js/motion.js?v=7.1.1"></script><script src="/js/affix.js?v=7.1.1"></script><script src="/js/schemes/pisces.js?v=7.1.1"></script><script src="/js/scrollspy.js?v=7.1.1"></script><script src="/js/post-details.js?v=7.1.1"></script><script src="/js/next-boot.js?v=7.1.1"></script><script src="/js/js.cookie.js?v=7.1.1"></script><script src="/js/scroll-cookie.js?v=7.1.1"></script><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={iconStyle:"box",boxForm:"horizontal",position:"bottomCenter",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-postbottom",pbOptions)</script><script>$(".highlight").not(".gist .highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("Copy").on("click",function(t){var e=$(this).parent().find(".code").find(".line").map(function(t,e){return $(e).text()}).toArray().join("\n"),n=document.createElement("textarea"),o=window.pageYOffset||document.documentElement.scrollTop;n.style.top=o+"px",n.style.position="absolute",n.style.opacity="0",n.readOnly=!0,n.value=e,document.body.appendChild(n),n.select(),n.setSelectionRange(0,e.length),n.readOnly=!1,document.execCommand("copy")?$(this).text("Copied"):$(this).text("Copy failed"),n.blur(),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("Copy")},300)}).append(e)})</script></body></html>